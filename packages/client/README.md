### Клиент игры Пакман

## Правила

1. Pac-Man начинает игру с 3 жизнями.
2. Съедание одной пеллеты приносит 10 очков.
3. Съедание всех пеллет завершает текущий уровень.
4. После завершения уровня доска сбрасывается до исходной конфигурации, за исключением жизней Pac-Man и счета игрока.
5. Съедание одного апгрейда приносит 50 очков.
6. Съедание апгрейда пугает всех не пуганных призраков, что замедляет их на некоторое время, зависящее от уровня игрока.
7. Съедание апгрейда не влияет на призраков в состоянии страха, кроме перезапуска фазы страха.
8. Столкновение со страшным призраком отправляет призрака в режим отступления на 3 секунды и стоит n очков, где n - количество напуганных призраков, атакованных с момента последнего съедания апгрейда.
9. Столкновение с призраком, который не в страхе, уменьшает жизни Pac-Man на 1 и возвращает персонажей на исходные позиции на доске.
10. Столкновение с призраком, когда у Pac-Man не остается жизней, завершает игру.

## Управление в игре

Игрок может управлять Pac-Man с помощью клавиш-стрелок на клавиатуре, чтобы перемещаться по внутренним границам доски. В случайные моменты четыре призрака проходят через режимы рассеивания и преследования, а также перемещаются случайно во время своего испуганного состояния или режима отступления.

Для пользователей мобильных устройств и планшетов, у которых нет клавиатуры, предусмотрена панель управления на экране, на которую можно нажимать, чтобы вызывать события клавиатуры для клавиш со стрелками.

## Движение призраков

Призраки имеют три паттерна движения: рассеивание, преследование и случайное движение.

Когда игра начинается, призраки начинают движение в своем цикле рассеивания-преследования.
В одном цикле призраки двигаются в режиме рассеивания в течение 7 секунд, а затем в режиме преследования - в течение 20 секунд.
Этот цикл повторяется до тех пор, пока игрок не потеряет жизнь или не перейдет на следующий уровень, после чего цикл сбрасывается и начинается заново.


Когда Pac-Man съедает апгрейд, призраки замедляются и находятся в состоянии страха и начинают движение по случайному шаблону.
Во время этой фазы страха таймер цикла рассеивания-преследования приостанавливается и возобновляется после окончания длительности таймера страха.
Если апгрейд съедается, пока эффекты предыдущего апгрейда еще действуют, фаза страха просто начинается заново с новым таймером.
Длительность этого таймера страха зависит от уровня, на котором находится игрок. 
На уровне 1 он составляет 7 секунд и постепенно уменьшается на полсекунды на каждом уровне, пока на 15 уровне он не достигнет 0 секунд.
После этого апгрейды фактически не будут влиять на игру, за исключением добавления 50 очков к счету игрока.

Когда Pac-Man съедает призрака в состоянии страха, съеденный призрак двигается случайно в режиме отступления.
Этот режим длится 3 секунды, в течение которых механика столкновения Pac-Man и призраков отключается, и скорость призраков увеличивается.
После 3 секунд призраки возвращаются к циклу преследования и рассеивания. 

Во время случайного движения призраков, когда они сталкиваются на перекрестках,
они выбирают случайное направление с помощью функции `Math.random()` 

### Рассеивание

У каждого призрака своя целевая плитка во время режима рассеивания. 

Эти четыре целевые плитки находятся в каждом из четырех углов доски: 
- красный призрак нацеливается на верхний правый угол; 
- розовый призрак нацеливается на верхний левый угол; 
- голубой призрак нацеливается на нижний правый угол; 
- оранжевый призрак нацеливается на нижний левый угол.

Как только призраки достигают своих целевых плиток, они будут кружить вокруг стены в своем углу.

### Режим преследования

Каждый призрак имеет свой уникальный паттерн преследования:

- Красный призрак просто стремится к позиции Pac-Man, выбирая самое короткое прямое расстояние до него.
- Розовый призрак целится в четыре плитки впереди Pac-Man, чтобы засадить его спереди.
- Голубой призрак определяет промежуточную позицию перед Pac-Man и целью становится вектор, образованный поворотом на 180° от этой позиции до позиции красного призрака. Это позволяет голубому призраку попытаться окружить Pac-Man, но движение голубого призрака может быть сложно предсказать из-за постоянно меняющихся позиций персонажей на доске.
- Оранжевый призрак начинает преследование, как красный призрак, когда находится на расстоянии более восьми плиток от Pac-Man. Однако, на расстоянии восьми плиток или ближе он начинает двигаться в режиме рассеивания и целится в нижний левый угол, что делает его менее предсказуемым и создает немного возможных укрытий для Pac-Man в нижнем левом углу.